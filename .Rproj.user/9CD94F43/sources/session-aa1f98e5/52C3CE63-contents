library(here)

# Starting point for the recursive search
root_path <- here("data", "prodShadow", "data")

# 1. Find every directory named "wavs", no matter how deep it is
wavs_dirs <- list.dirs(root_path, recursive = TRUE, full.names = TRUE)
wavs_dirs <- wavs_dirs[basename(wavs_dirs) == "wavs"]

# 2. Pattern: keep files ending in "a.wav" or "a<number>.wav"
keep_pattern <- "a([0-9]+)?\\.wav$"

# 3. Loop through every wavs folder and clean it
for (wd in wavs_dirs) {
  
  # all .wav files in this folder
  wav_files <- list.files(
    wd,
    pattern = "\\.wav$",
    full.names = TRUE
  )
  
  # determine which should be kept
  keep <- grepl(keep_pattern, basename(wav_files))
  
  # figure out which to delete
  to_remove <- wav_files[!keep]
  
  # delete unwanted files
  if (length(to_remove) > 0) {
    file.remove(to_remove)
  }
  
  cat("Cleaned:", wd, "\n")
}


